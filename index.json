[{"authors":["Noel"],"categories":["container"],"content":" This post is a memo on how I did the installtion of Kubernetes and Calico on VMs. It\u0026rsquo;s not some best pactrices in anyway.\nI\u0026rsquo;ve chose VM because I didn\u0026rsquo;t want to depend on any Cloud infrastructure. I\u0026rsquo;ve also wanted to understand the network interaction between K8s parts from an infrastructure point of view.\nPrerequisite : know how to create VMs on any hypervisors\nSteps to deploy K8s :  Install 1 ubuntu router with 3 interfaces. 1 for NAT/Internet access and 2 for the K8s LAN. I\u0026rsquo;ve created 2 LAN to see what happen under the hood when K8s nodes communicates.\n Install 3 Ubuntu servers, 1 for the master and 2 for the workers. 1 worker in the same ethernet segment and subnet than the master. 1 worker in another network.\n Gotchas:  By default, the K8s interface is the one with the default route. All my servers have one OOB interface and one production interface. Special tunning for k8s =\u0026gt; turn off the swap   Install runtime and enable it on boot\n Installing kubeadm, kubelet and kubectl\n Initializing the master (choose the pod network add-on before to add the relevent parameters, Calico parameters in my case)\n Install the pod network add-on\n Join node/workers to the cluster\n That it, you can now play with the K8s cluster\n  Optional : Install ctl for calico\nComments : To create anything you just have to kubectl apply -f myfile The magic happen in myfile where you describe what you want to create.\nDetails of the tasks 3. https://kubernetes.io/docs/setup/independent/install-kubeadm/#installing-runtime\nI\u0026rsquo;ve needed to add the following commands\nsystemctl enable docker.service systemctl start docker.service  4. https://kubernetes.io/docs/setup/independent/install-kubeadm/#installing-kubeadm-kubelet-and-kubectl\napt-get update \u0026amp;amp;\u0026amp;amp; apt-get install -y apt-transport-https curl curl -s https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add - cat \u0026amp;lt;\u0026amp;lt;EOF \u0026amp;gt;/etc/apt/sources.list.d/kubernetes.list deb http://apt.kubernetes.io/ kubernetes-xenial main EOF apt-get update apt-get install -y kubelet kubeadm kubectl apt-mark hold kubelet kubeadm kubectl  5.\nkubeadm init --pod-network-cidr=192.168.0.0/16 mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/config  6.\nkubectl apply -f https://docs.projectcalico.org/v3.1/getting-started/kubernetes/installation/hosted/rbac-kdd.yaml kubectl apply -f https://docs.projectcalico.org/v3.1/getting-started/kubernetes/installation/hosted/kubernetes-datastore/calico-networking/1.7/calico.yaml  7.\nkubeadm join 10.0.1.10:6443 --token d34b9i.v03t2yiozio63cq6 --discovery-token-ca-cert-hash sha256:c21d04ea23790a0bf81cf64118e3a9075ffb63ed90bc697acef5793386e9eb16  Cheat Sheet\n","date":1538603959,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1538603959,"objectID":"04e4be9702fa5b85a26f6612d64762cc","permalink":"/post/k8s-on-vms-with-calico/","publishdate":"2018-10-03T23:59:19+02:00","relpermalink":"/post/k8s-on-vms-with-calico/","section":"post","summary":"This post is a memo on how I did the installtion of Kubernetes and Calico on VMs. It\u0026rsquo;s not some best pactrices in anyway.\nI\u0026rsquo;ve chose VM because I didn\u0026rsquo;t want to depend on any Cloud infrastructure. I\u0026rsquo;ve also wanted to understand the network interaction between K8s parts from an infrastructure point of view.\nPrerequisite : know how to create VMs on any hypervisors\nSteps to deploy K8s :  Install 1 ubuntu router with 3 interfaces.","tags":["calico","docker","k8s","kubernetes","netplan","ubuntu","virtualbox"],"title":"K8s on Vms With Calico","type":"post"},{"authors":["Noel"],"categories":["container"],"content":" Hey HHEY # Heading Level 1 Some test ## Heading Level 2 Some more test  ","date":1538595928,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1538595928,"objectID":"341ac8c91f9767bb9f6e96046cd974c3","permalink":"/post/myfirstpost/","publishdate":"2018-10-03T21:45:28+02:00","relpermalink":"/post/myfirstpost/","section":"post","summary":" Hey HHEY # Heading Level 1 Some test ## Heading Level 2 Some more test  ","tags":["kubernetes","calico"],"title":"Myfirstpost","type":"post"}]